{"version":3,"sources":["symbol_background.png","index.js"],"names":["module","exports","route_dict","17_Ave","south_cross","north_cross","route_color","mapboxgl","accessToken","Application","props","_this","Object","_Users_saadiqmohiuddin_Documents_Coding_Data_Visualization_calgary_brt_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","_Users_saadiqmohiuddin_Documents_Coding_Data_Visualization_calgary_brt_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","_Users_saadiqmohiuddin_Documents_Coding_Data_Visualization_calgary_brt_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","handle","bind","_Users_saadiqmohiuddin_Documents_Coding_Data_Visualization_calgary_brt_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__","errordiv","connections","toggle_layer","state","lng","lat","zoom","max_route","stop_name","bus_query","active_route","active_conn","height","width","setState","window","innerHeight","innerWidth","_this2","_this$state","map","Map","container","mapContainer","style","center","maxZoom","minZoom","on","geojson","addSource","type","data","max_lines","max_stops","features","feature","layer_name","properties","route_name","addLayer","id","source","paint","line-color","line-width","line-opacity","layout","line-join","line-cap","filter","circle-color","circle-radius","stops","circle-opacity","circle-stroke-width","circle-stroke-color","img","Image","onload","addImage","src","symbol","icon-image","icon-text-fit","icon-text-fit-padding","symbol-placement","symbol-spacing","icon-rotation-alignment","text-rotation-alignment","text-field","String","text-size","text-font","text-transform","text-letter-spacing","text-offset","text-color","popup","Popup","closeButton","closeOnClick","anchor","offset","forEach","over","leave","click","value","_this3","pad","top","bottom","left","right","setPaintProperty","setFilter","bounds","bbox","geometry","getPaintProperty","fitBounds","padding","output","arguments","length","undefined","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","placeholder","document","getElementById","text","ReactDOM","render","index","e","preventDefault","target","getAttribute","setLayoutProperty","remove","route","x","push","indexOf","getCanvas","cursor","_this4","_this5","querySelectorAll","element","textContent","classList","replace","fetch","then","response","json","error","getSource","setData","_this6","f","queryRenderedFeatures","point","layers","connection","split","routeConnections","key","className","onClick","setLngLat","coordinates","setDOMContent","addTo","_this7","max_routes","label","line_style","background","borderRadius","marginBottom","ref","el","href","React","Component"],"mappings":"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","file":"static/js/main.90472a85.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAADX0lEQVRogeXbz2tcVRjG8U+uEjdqhFZBU4TulNKFWhSLJk3VhUsttdC10r/AvW7dCBbbhduikFK7UJCCVZgEglJRid1akCoYjaS1q5JwXLwzdRznzkxm7o/OzBdmce+cOfM83HPuPfc97zuTUlISc3geh3AA+zGPh3B/s80tbOE3/IyruII13ChD1EzBhvfhBF7Hc7hnyH528A0+xXn8Uog6SCkV8VlIKX2WUtpOxbPd7HuxCK2jdnAkpdQowWQejeZ/Vm740ZTSuQoM5nGuqWHX2oeZw8fxkbgp1ckNvCXm+MBku2g7i9NYVr9ZQsOy0HTfoD8a9Ao/gIt4aShp5dPAa/irX8NBDD+ML/DM6LpK5Ue8gj96NepneA5f4enidJXK91jSY9HSaw7Pigf/uJiFp4Tm2bwGvQy/j6NFK6qAo0J7V/KG9HFxBxxnTujioZvhefwkFvnjzBYO4nr7yW5D+rTxN0t4+KDzZOcVXhJ35UniZVxuHXQaXsELVSsqmVW82DpoH9ILJs8s4WmhddBu+O3qtVTGHW+tIf0IfsW9dSkqmW3x9NloXeGTJtcs4e0k/w7pY/VpqYxjxJCew6bhA27jwg72ZDhs8s0SHg9nxuttaFQOZWK9OS0cyMSOwLSwP8NjdauokPnMZLwZDcqDM2mIwPQ4s5u49CRwOxNbltPCrUyEQqaFvzOxGT0t/J7hWt0qKuRaJiKU08LVDN/VraJCrkzb6+HeTGw8rdUspgrWsNVaeFyoU0lFXGCKg3gbuFSfntK5JDz+Zy39Xj1aKuGOt3bDDbEtMWmsCm/4/9vSO5VKqYZ32w86DV8W2TqTwkV82X6i24b4Pqwb/0jIwBvi13GqCkUlc0qHWfIjHss4W6qccjkrJ0elV57WrHh+HSlHU2k0RILa7W5f9ktM24OvjU+wfl2kbWzmNegXxNsUORI/FCiqLNaF1lyzDBa13MCiuNJ3Kyti6m30azhomPYmXsWHw2sqjTNizvbNpGW4Io+7JUH8Jt5UYoJ4i/N4Eh8P8dui+ARP2KVZFFLksVJ4RUM+qymlpVE0F1XGs5hS+jyltFOCyZ1m34tFaC26UOtxvCEKtZ41WqHWtyL3eVmBhVpFG26nvRTvoNh436t7Kd6fYkNgXcmleP8AjUHINmktS24AAAAASUVORK5CYII=\"","\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles.css';\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport mapboxgl from 'mapbox-gl'\nimport max_lines from './max_lines.json'\nimport max_stops from './max_stops.json'\nimport { bbox } from '@turf/turf'\nimport symbol from './symbol_background.png';\n\nlet route_dict = {\n  '17_Ave': \"MAX PURPLE\",\n  \"south_cross\": 'MAX TEAL',\n  'north_cross': 'MAX ORANGE'\n};\n\nlet route_color = {\n  '17_Ave': \"purple\",\n  \"south_cross\": 'teal',\n  'north_cross': 'orange'\n};\n\nmapboxgl.accessToken = 'pk.eyJ1Ijoic2FhZGlxbSIsImEiOiJjamJpMXcxa3AyMG9zMzNyNmdxNDlneGRvIn0.wjlI8r1S_-xxtq2d-W5qPA';\n\nclass Application extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.handle = this.handle.bind(this)\n    this.errordiv = this.errordiv.bind(this)\n    this.connections = this.connections.bind(this)\n    this.toggle_layer = this.toggle_layer.bind(this)\n    this.state = {\n      lng: -114.0708,\n      lat: 51.0486,\n      zoom: 10.7,\n      max_route: '17_ave',\n      stop_name: \"\",\n      connections: [],\n      bus_query: null,\n      active_route: null,\n      active_conn: null,\n      height:props.height,\n      width: props.width\n    };\n  }\n\n  componentWillMount(){\n    this.setState({height: window.innerHeight,width:window.innerWidth});\n\n  }\n\n  componentDidMount() {\n\n    const {lng, lat, zoom} = this.state;\n    this.map = new mapboxgl.Map({\n      container: this.mapContainer,\n      style: 'mapbox://styles/saadiqm/cjbjougmt08z72rsa7me1duoi',\n      center: [lng, lat],\n      zoom: zoom,\n      maxZoom: 13,\n      minZoom: 8,\n    });\n\n    this.map.on('load', () => {\n\n      let geojson = 'https://data.calgary.ca/resource/hpnd-riq4.geojson?route_short_name='+this.state.bus_query+'&$select=multiline'\n\n      this.map.addSource('Bus Route', {\n        type: 'geojson',\n        data: geojson\n      });\n\n      this.map.addSource('Max Routes', {\n        type: 'geojson',\n        data: max_lines\n      });\n      this.map.addSource('Max Stops', {\n        type: 'geojson',\n        data: max_stops\n      });\n\n      max_lines.features.map((feature)=>{\n        let layer_name = feature.properties.route_name\n        return this.map.addLayer({\n            \"id\": layer_name,\n            \"type\": \"line\",\n            \"source\": 'Max Routes',\n            \"paint\": {\n                \"line-color\": [\n                  'match',\n                  ['get', 'route_name'],\n                  'south_cross', 'teal',\n                  'north_cross', 'orange',\n                  '17_Ave', 'purple',\n                  'blue'\n                ],\n                \"line-width\": 10,\n                \"line-opacity\": 0.3\n            },\n            \"layout\": {\n                \"line-join\": \"round\",\n                \"line-cap\": \"round\"\n            },\n            \"filter\": [\"==\", \"route_name\", layer_name]\n        });\n\n      });\n\n      this.map.addLayer({\n          \"id\": \"Bus Route\",\n          \"type\": \"line\",\n          \"source\": 'Bus Route',\n          \"paint\": {\n              \"line-color\": \"red\",\n              \"line-width\": 4,\n              \"line-opacity\": 0.4\n          },\n          \"layout\": {\n              \"line-join\": \"round\",\n              \"line-cap\": \"round\"\n          },\n      });\n\n      this.map.addLayer({\n          \"id\": \"Max Stops\",\n          \"type\": \"circle\",\n          \"source\": 'Max Stops',\n          \"paint\": {\n              \"circle-color\": \"white\",\n              'circle-radius':{\n                  stops: [[8, 4], [11, 6], [16, 20]]\n              },\n              \"circle-opacity\": 0.7\n          },\n          \"filter\": [\"==\", \"route_name\", '']\n      });\n\n      this.map.addLayer({\n          \"id\": \"Selected Stop\",\n          \"type\": \"circle\",\n          \"source\": 'Max Stops',\n          \"paint\": {\n              \"circle-color\": \"white\",\n              'circle-radius':{\n                stops: [[8, 4], [11, 6], [16, 20]]\n              },\n              \"circle-opacity\": 0.9,\n              \"circle-stroke-width\": 4,\n              \"circle-stroke-color\": '#a5a5a5'\n          },\n          \"filter\": [\"==\", \"stop_name\", '']\n      });\n\n\n      let img = new Image(27,27)\n      img.onload = ()=> this.map.addImage('bus', img)\n      img.src = symbol\n\n      this.map.addLayer({\n          \"id\": \"symbols\",\n          \"type\": \"symbol\",\n          \"source\": \"Bus Route\",\n          \"layout\": {\n            \"icon-image\": \"bus\",\n            \"icon-text-fit\":'none',\n            \"icon-text-fit-padding\":[3,3,3,3],\n            \"symbol-placement\":  \"line\",\n            'symbol-spacing':1000,\n            'icon-rotation-alignment': 'viewport',\n            'text-rotation-alignment':'viewport',\n            \"text-field\": String(this.state.bus_query), // part 2 of this is how to do it\n            \"text-size\": 12,\n            \"text-font\": [\"Open Sans Bold\", \"Arial Unicode MS Bold\"],\n            \"text-transform\": \"uppercase\",\n            \"text-letter-spacing\": 0.05,\n            \"text-offset\": [0, 0]\n          },\n          \"paint\": {\n              \"text-color\": \"red\"\n          }\n      });\n\n    });\n\n\n\n    this.popup = new mapboxgl.Popup({\n            closeButton: false,\n            closeOnClick: true,\n            anchor: 'bottom-left',\n            offset: [10,-15]\n    });\n\n    this.map.on('mouseover',\"Max Stops\",this.stops.bind(this));\n\n    max_lines.features.forEach((feature)=>{\n      let layer_name = feature.properties.route_name\n      this.map.on('mouseenter',layer_name, this.over.bind(this));\n      this.map.on('mouseleave', layer_name, this.leave.bind(this));\n      this.map.on('click', layer_name, this.click.bind(this));\n    });\n\n  }\n\n  toggle_layer(value){\n\n    let pad = {}\n    if (this.state.width<500){\n      pad ={top:this.state.height*0.4, bottom: 15, left:15, right:15};\n    } else {\n      pad ={top:this.state.height*0.1, bottom:this.state.height*0.1, left:this.state.width*0.3, right:this.state.height*0.1};\n    }\n\n    max_lines.features.forEach((feature)=>{\n      let layer_name = feature.properties.route_name\n\n      if(layer_name===value){\n        this.map.setPaintProperty(value, 'line-opacity', 1);\n        this.map.setFilter('Max Stops',['==', 'route_name', value])\n\n        let bounds= bbox(feature.geometry);\n\n        if(this.map.getPaintProperty(value, 'line-opacity') === 1){\n          this.map.fitBounds(bounds, {\n            padding: {top: pad.top, bottom:pad.bottom, left: pad.left, right: pad.right}\n          });\n        }\n      }else{\n        this.map.setPaintProperty(layer_name, 'line-opacity', 0.4);\n      }\n\n    });\n  }\n\n  errordiv(output=<div></div>){\n    const placeholder = document.getElementById(\"error\");\n    let text = output\n    ReactDOM.render(text, placeholder);\n  }\n\n  handle(index, e){\n    e.preventDefault();\n\n    this.setState({ active_route: index, active_conn:null,bus_query: null, connections:[], stop_name:'' });\n\n    let value = e.target.getAttribute('value')\n\n    this.toggle_layer(value)\n    this.map.setLayoutProperty('Bus Route', 'visibility', 'none');\n    this.map.setLayoutProperty('symbols', 'visibility', 'none');\n    this.popup.remove()\n\n    this.errordiv()\n\n  }\n\n  click(e){\n    e.preventDefault();\n    let value = e.features[0].properties.route_name\n\n    let route = []\n    max_lines.features.forEach(x => route.push(x.properties.route_name))\n    let index = route.indexOf(value)\n\n    this.setState({ active_route: index, active_conn:null, bus_query: null});\n    this.toggle_layer(value)\n    this.map.setLayoutProperty('Bus Route', 'visibility', 'none');\n    this.map.setLayoutProperty('symbols', 'visibility', 'none');\n\n    this.errordiv()\n\n  }\n\n  over(e){\n    let route = e.features[0].properties.route_name\n    this.map.getCanvas().style.cursor = 'pointer';\n    if(this.map.getPaintProperty(route, 'line-opacity') !== 1){\n      this.map.setPaintProperty(route, 'line-opacity', 0.8);\n    }\n  }\n\n  leave(e){\n    this.map.getCanvas().style.cursor = '';\n    max_lines.features.forEach((feature)=>{\n      let route = feature.properties.route_name\n      if(this.map.getPaintProperty(route, 'line-opacity') !== 1){\n        this.map.setPaintProperty(route, 'line-opacity', 0.4);\n      }\n    });\n  }\n\n  connections(x, e){\n    e.preventDefault();\n\n    let pad = {}\n    if (this.state.width<500){\n      pad ={top:this.state.height*0.4, bottom: 15, left:15, right:15};\n    } else {\n      pad ={top:this.state.height*0.1, bottom:this.state.height*0.1, left:this.state.width*0.3, right:this.state.height*0.1};\n    }\n\n    this.setState({bus_query: x}, () => { //update selected bus route\n\n      let demoId = document.querySelectorAll('#bus_node');\n      demoId.forEach(element => {\n        if(this.state.bus_query===element.textContent){\n          element.classList.replace('bus_select2','bus_list2')\n        }else{\n          element.classList.replace('bus_list2','bus_select2')\n        }\n      });\n\n      let geojson = 'https://data.calgary.ca/resource/hpnd-riq4.geojson?route_short_name='+this.state.bus_query+'&$select=multiline'\n\n      this.map.setLayoutProperty('symbols', 'text-field', String(this.state.bus_query))\n\n      fetch(geojson)\n        .then(response => {\n            return response.json();\n        }).then(data => {\n\n          try{\n            let bounds= bbox(data); //find bounding box using Turf\n            this.map.fitBounds(bounds, {\n              padding: {top: pad.top, bottom:pad.bottom, left: pad.left, right: pad.right}\n            });\n            this.errordiv()\n          }\n          catch(error) {\n            this.errordiv(<h3>Cannot show this bus route</h3>)\n          }\n        });\n\n      this.map.getSource('Bus Route').setData(geojson);\n      this.map.setLayoutProperty('Bus Route', 'visibility', 'visible');\n      this.map.setLayoutProperty('symbols', 'visibility', 'visible');\n\n    })\n\n  }\n\n  stops(e){\n\n    let f = this.map.queryRenderedFeatures(e.point, { layers: ['Max Stops'] });\n    this.setState({ active_conn: null });\n\n    if(f.length > 0){\n      this.setState({\n        stop_name:f[0].properties.stop_name,\n        connections:f[0].properties.connection.split(',')\n      });\n\n      this.map.setFilter('Selected Stop',['==', 'stop_name', this.state.stop_name])\n\n      let routeConnections = this.state.connections.map((x, index) => {\n        let output\n        if(x===\"null\"){\n          output = <span value={x} key={x}>No Connections</span>\n        }else{\n\n          output = <span id=\"bus_node\" className='bus_select2' onClick={this.connections.bind(this, x)} value={x} key={x}>{x}</span>\n\n        }\n        return output\n      });\n\n      let text = <div><h2>{this.state.stop_name}</h2>{routeConnections}</div>\n\n      const placeholder = document.createElement('div');\n      ReactDOM.render(text, placeholder);\n\n      this.popup.setLngLat(f[0].geometry.coordinates).setDOMContent(placeholder).addTo(this.map);\n    }\n\n  }\n\n  render() {\n\n    let max_routes = max_lines.features.map((x, index) => {\n\n      let value = x.properties.route_name;\n      let label = route_dict[x.properties.route_name]\n\n      const line_style = {height:'3px', background:route_color[x.properties.route_name],  borderRadius:'8px'}\n\n      return  <li style={{marginBottom: '10px'}} className={this.state.active_route===index ? 'route_list': 'route_select'} onClick={this.handle.bind(this, index)} value ={value} key={value}>{label}  <hr style={line_style} /></li>\n\n\n\n    });\n\n\n    return (\n      <div>\n        <div ref={el => this.mapContainer = el} className=\"absolute top right left bottom\" />\n\n        <div className=\"border_box\">\n\n          <h1>CALGARY TRANSIT BRT SYSTEM MAP</h1>\n\n          <div>\n            <ul>\n              {max_routes}\n            </ul>\n          </div>\n\n          <div id=\"error\"></div>\n\n          <div className='byline'>\n            <h4>&copy;2018 Saadiq Mohiuddin <a href=\"https://www.twitter.com/saadiqmohiuddin\">@saadiqmohiuddin</a></h4>\n          </div>\n\n\n        </div>\n      </div>\n\n    );\n  }\n}\nReactDOM.render(<Application />, document.getElementById('root'));\n"],"sourceRoot":""}